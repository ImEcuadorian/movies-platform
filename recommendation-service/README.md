# Recommendation Service

RESTful API to manage movie or series recommendations.

---

## ðŸ“¦ Technologies

* **Language**: Python 3.13
* **Web Framework**: FastAPI
* **ORM**: SQLAlchemy
* **Validation**: Pydantic
* **Database**: PostgreSQL
* **Containerization**: Docker, Docker Compose
* **Dependency Management**: Poetry

---

## ðŸ“ Project Structure

```bash
recommendation-service/
â”œâ”€â”€ .env                    # Environment variables
â”œâ”€â”€ Dockerfile              # Docker image definition
â”œâ”€â”€ docker-compose.yml      # Service orchestration
â”œâ”€â”€ pyproject.toml          # Project metadata and dependencies (Poetry)
â”œâ”€â”€ poetry.lock             # Lockfile generated by Poetry
â”œâ”€â”€ README.md               # Project documentation
â”œâ”€â”€ src/
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ core/           # Shared configuration and utilities
â”‚       â”œâ”€â”€ db/             # SQLAlchemy setup (Base, session)
â”‚       â”œâ”€â”€ models/         # ORM models definitions
â”‚       â”œâ”€â”€ schemas/        # Pydantic schemas (DTOs)
â”‚       â”œâ”€â”€ crud/           # Data access functions
â”‚       â”œâ”€â”€ services/       # Business logic
â”‚       â””â”€â”€ api/            # FastAPI routers (/api/v1)
â”‚           â””â”€â”€ v1/
â”‚               â”œâ”€â”€ recommendation/  # Endpoint definitions
â”‚       â””â”€â”€ main.py         # FastAPI application entry point
â””â”€
   
```

---

## âš™ï¸ Prerequisites

* Docker and Docker Compose installed
* Environment variables set in `.env` (see next section)

---

## ðŸ”‘ Environment Variables (.env)

```dotenv
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=recommendations_db

# SQLAlchemy connection URL
SQLALCHEMY_DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db:5432/${POSTGRES_DB}
```

> **Note**: The PostgreSQL service is named `db` in Docker Compose, hence that hostname.

---

## ðŸš€ Installation & Run

### Using Docker Compose (recommended)

1. From the project root, start services:

   ```bash
   docker-compose up --build
   ```
2. Access the API:

    * Swagger UI: `http://localhost:8000/docs`
    * Redoc: `http://localhost:8000/redoc`

### Locally (without containers)

1. Clone the repo and activate a virtual environment:

   ```bash
   python -m venv .venv
   source .venv/bin/activate   # Linux/macOS
   .\.venv\Scripts\activate  # Windows
   ```
2. Install dependencies via Poetry or pip:

   ```bash
   poetry install
   # or
   pip install -r requirements.txt
   ```
3. Ensure PostgreSQL is running with the same credentials as in `.env`.
4. Apply migrations or let the app auto-create tables on startup.
5. Run the app:

   ```bash
   uvicorn app.main:app --reload
   ```

---

## ðŸ“¡ Available Endpoints

| Method | Path                           | Description                       |
| ------ | ------------------------------ | --------------------------------- |
| GET    | `/api/v1/recommendations`      | List all recommendations          |
| GET    | `/api/v1/recommendations/{id}` | Get a recommendation by ID        |
| POST   | `/api/v1/recommendations`      | Create a new recommendation       |
| PUT    | `/api/v1/recommendations/{id}` | Update an existing recommendation |
| DELETE | `/api/v1/recommendations/{id}` | Delete a recommendation by ID     |

**Sample POST Request** (JSON body):

```json
{
  "titulo": "Inception",
  "genero": "Science Fiction",
  "puntaje": 9,
  "comentario": "A mind-bending masterpiece.",
  "vista": true
}
```

---

## âœ… Best Practices (Clean Code)

* **Descriptive names**: functions like `get_all_recommendations`, schemas `RecommendationCreate`, etc.
* **Single responsibility**: separate routers, services, CRUD, and models into distinct layers.
* **Modularity**: avoid monolithic files; each folder has a focused purpose.
* **DRY**: extract shared logic into helpers or service classes.
* **Error handling**: use `HTTPException` with proper status codes and clear messages.
* **Formatting & linting**: use `black`, `flake8` or `ruff`, and `mypy` for type checks.

---

## ðŸŽ¯ Evaluation Criteria (10 points)

| Criterion                                         | Points |
| ------------------------------------------------- | :----: |
| Fully functional GET, POST, PUT, DELETE endpoints |    2   |
| Correct modeling with SQLAlchemy                  |    2   |
| Data validation with Pydantic                     |    2   |
| Reproducible and efficient Dockerfile             |    2   |
| Use of Docker Compose for service orchestration   |    2   |

---

## ðŸ“„ License

This project is licensed under the **MIT License**. Â© 2025
