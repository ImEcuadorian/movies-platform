# Recommendation Service

RESTful API to manage movie or series recommendations.

---

## 📦 Technologies

* **Language**: Python 3.13
* **Web Framework**: FastAPI
* **ORM**: SQLAlchemy
* **Validation**: Pydantic
* **Database**: PostgreSQL
* **Containerization**: Docker, Docker Compose
* **Dependency Management**: Poetry

---

## 📁 Project Structure

```bash
recommendation-service/
├── .env                    # Environment variables
├── Dockerfile              # Docker image definition
├── docker-compose.yml      # Service orchestration
├── pyproject.toml          # Project metadata and dependencies (Poetry)
├── poetry.lock             # Lockfile generated by Poetry
├── README.md               # Project documentation
├── src/
│   └── app/
│       ├── core/           # Shared configuration and utilities
│       ├── db/             # SQLAlchemy setup (Base, session)
│       ├── models/         # ORM models definitions
│       ├── schemas/        # Pydantic schemas (DTOs)
│       ├── crud/           # Data access functions
│       ├── services/       # Business logic
│       └── api/            # FastAPI routers (/api/v1)
│           └── v1/
│               ├── recommendation/  # Endpoint definitions
│       └── main.py         # FastAPI application entry point
└─
   
```

---

## ⚙️ Prerequisites

* Docker and Docker Compose installed
* Environment variables set in `.env` (see next section)

---

## 🔑 Environment Variables (.env)

```dotenv
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=recommendations_db

# SQLAlchemy connection URL
SQLALCHEMY_DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db:5432/${POSTGRES_DB}
```

> **Note**: The PostgreSQL service is named `db` in Docker Compose, hence that hostname.

---

## 🚀 Installation & Run

### Using Docker Compose (recommended)

1. From the project root, start services:

   ```bash
   docker-compose up --build
   ```
2. Access the API:

    * Swagger UI: `http://localhost:8000/docs`
    * Redoc: `http://localhost:8000/redoc`

### Locally (without containers)

1. Clone the repo and activate a virtual environment:

   ```bash
   python -m venv .venv
   source .venv/bin/activate   # Linux/macOS
   .\.venv\Scripts\activate  # Windows
   ```
2. Install dependencies via Poetry or pip:

   ```bash
   poetry install
   # or
   pip install -r requirements.txt
   ```
3. Ensure PostgreSQL is running with the same credentials as in `.env`.
4. Apply migrations or let the app auto-create tables on startup.
5. Run the app:

   ```bash
   uvicorn app.main:app --reload
   ```

---

## 📡 Available Endpoints

| Method | Path                           | Description                       |
| ------ | ------------------------------ | --------------------------------- |
| GET    | `/api/v1/recommendations`      | List all recommendations          |
| GET    | `/api/v1/recommendations/{id}` | Get a recommendation by ID        |
| POST   | `/api/v1/recommendations`      | Create a new recommendation       |
| PUT    | `/api/v1/recommendations/{id}` | Update an existing recommendation |
| DELETE | `/api/v1/recommendations/{id}` | Delete a recommendation by ID     |

**Sample POST Request** (JSON body):

```json
{
  "titulo": "Inception",
  "genero": "Science Fiction",
  "puntaje": 9,
  "comentario": "A mind-bending masterpiece.",
  "vista": true
}
```

---

## ✅ Best Practices (Clean Code)

* **Descriptive names**: functions like `get_all_recommendations`, schemas `RecommendationCreate`, etc.
* **Single responsibility**: separate routers, services, CRUD, and models into distinct layers.
* **Modularity**: avoid monolithic files; each folder has a focused purpose.
* **DRY**: extract shared logic into helpers or service classes.
* **Error handling**: use `HTTPException` with proper status codes and clear messages.
* **Formatting & linting**: use `black`, `flake8` or `ruff`, and `mypy` for type checks.

---

## 🎯 Evaluation Criteria (10 points)

| Criterion                                         | Points |
| ------------------------------------------------- | :----: |
| Fully functional GET, POST, PUT, DELETE endpoints |    2   |
| Correct modeling with SQLAlchemy                  |    2   |
| Data validation with Pydantic                     |    2   |
| Reproducible and efficient Dockerfile             |    2   |
| Use of Docker Compose for service orchestration   |    2   |

---

## 📄 License

This project is licensed under the **MIT License**. © 2025
